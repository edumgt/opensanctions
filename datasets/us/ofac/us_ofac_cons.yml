title: US OFAC Consolidated (non-SDN) List
entry_point: ofac_advanced.py
prefix: ofac
coverage:
  frequency: daily
  start: "2015-12-05"
  schedule: "0 */2 * * *"
deploy:
  memory: 1300Mi
  memory_limit: "2Gi"
  cpu: "200m"
load_statements: true
summary: >
  OFAC is providing all of its non-SDN sanctions lists in a consolidated set
  of data called "the Consolidated Sanctions List".
description: |
  In order to make it easier to comply with OFAC's sanctions regulations, OFAC is
  offering all of its non-SDN sanctions lists in a consolidated set of data
  files called "the Consolidated Sanctions List".

  In the future, if OFAC creates a new non-SDN style list, the office will add
  the new data associated with that list to these consolidated data files if
  appropriate. While the consolidated sanctions list data files are not part of OFAC's
  list of Specially Designated Nationals and Blocked Persons "the SDN List," the records
  in these consolidated files may also appear on the SDN List.
publisher:
  name: Office of Foreign Assets Control
  acronym: OFAC
  description: >
    OFAC is a divison of the United States Department of the Treasury that administers
    and enforces economic and trade sanctions based on US foreign policy and national
    security goals against targeted foreign countries and regimes, terrorists,
    international narcotics traffickers, those engaged in activities related to the
    proliferation of weapons of mass destruction, and other threats to the national
    security, foreign policy or economy of the Unitedâ€‹ States.
  country: us
  url: https://www.treasury.gov/
  official: true
url: https://www.treasury.gov/resource-center/sanctions/Pages/default.aspx
data:
  url: https://www.treasury.gov/ofac/downloads/sanctions/1.0/cons_advanced.xml
  format: XML
  lang: eng

assertions:
  min:
    schema_entities:
      Address: 440
      Organization: 300
      Security: 200
      Person: 70
      Company: 4
  max:
    schema_entities:
      Address: 1030
      Organization: 720
      Security: 460
      Person: 160
      Company: 50

lookups:
  sanction.program:
    options:
      - match: 561-RELATED
        value: US-CAPTA
      - match: 
          - BALKANS
          - BALKANS-EO14033
        value: US-BALKANS
      - match: 
          - BELARUS
          - BELARUS-EO14038
        value: US-BELARUS
      - match: CAR
        value: US-CAR
      - match: CUBA
        value: US-CUBA
      - match: ILLICIT-DRUGS-EO14059
        value: US-NARCO
      - match:
          - CYBER2
          - CYBER3
        value: US-CYB
      - match: DRCONGO
        value: US-DRC
      - match: ETHIOPIA-EO14046
        value: US-ETHIOPIA
      - match: GLOMAG
        value: US-GLOMAG
      - match: MAGNIT
        value: US-MAGNITSKY
      - match: MALI-EO13882
        value: US-MALI
      - match: 
          - NICARAGUA
          # - NICARAGUA-NHRAA
        value: US-NICARAGUA
      - match: NPWMD
        value: US-NON-PROLIF
      - match: 
        - DPRK
        - DPRK2
        - DPRK3
        - DPRK4
        # - DPRK-NKSPEA
        value: US-DPRK
      - match: BPI-RUSSIA-EO14024
        value: US-RUSHAR
      - match: SOMALIA
        value: US-SOMALIA
      - match: SOUTH SUDAN
        value: US-SOUTH-SUDAN
      - match: 
          - DARFUR
          - BPI-Sudan-14098
        value: US-DARFUR
      - match: SYRIA-EO13894
        value: US-SYR-REL
      - match: 
          - HRIT-SY
          - SYRIA
        value: US-SYR
      - match:
          - VENEZUELA
          - VENEZUELA-EO13850
          - VENEZUELA-EO13884
        value: US-VEN
      - match: YEMEN
        value: US-YEMEN
      - match:
          - UKRAINE-EO13660
          - UKRAINE-EO13661
          - UKRAINE-EO13662
          - UKRAINE-EO13685
          - RUSSIA-EO14065
        value: US-UKRRUS-REL
      - match: 
          # - LIBYA2
          - LIBYA3
        value: US-LIBYA
      - match: LEBANON
        value: US-LEBANON
      - match:
          - IRAQ2
          - IRAQ3
        value: US-IRAQ
      - match:
          - FSE-IR
          - HRIT-IR
          - IRAN-EO13846
          - IRAN-EO13876
          - IRAN-EO13871
          - IRAN-EO13902
          - IRAN-HR
        value: US-IRAN
      - match: BURMA-EO14014
        value: US-BURMA
      - match: CMIC-EO13959
        # TODO: Check if this is correct
        values: 
          - US-CHINA-MIL
          - US-NS-CMIC
      - match: FSE-IR
        value: US-FSE
      - match: NS-PLC
        value: US-NS-PLC
      - match: UKRAINE-EO13662
        # TODO: Fix the overlap with US-UKRRUS-REL
        value: US-SSI
      
      # To be mapped (based on https://ofac.treasury.gov/specially-designated-nationals-list-sdn-list/program-tag-definitions-for-ofac-sanctions-lists)
      #
      # SYRIA-CAESAR
      # BPI-SDNTK
      # CAATSA - RUSSIA
      # CAATSA - IRAN
      # CAATSA - RUSSIA     
      # ELECTION-EO13848
      # FTO
      # HIFPAA
      # HK-EO13936
      # HOSTAGES-EO14078
      # HRIT-SY
      # HRIT-IR
      # ICC-EO14203
      # IFCA
      # IFSR
      # IRAN
      # IRAN-CON-ARMS-EOs
      # IRAN-TRA
      # IRGC
      # ISA
      # PEESA-EO14039
      # RUSSIA-EO14024
      # SDGT
      # SDNT
      # SDNTK
      # SSIDES
      # SUDAN
      # SUDAN-EO14098
      # TCO
      # UHRPA
  type.address:
    lowercase: true
    options:
      - match:
          - Russia
          - Turkey
        value: null
      - match: Moscow
        value: Moscow
  type.email:
    options:
      - match: PRIYEMNAYA@YGDU
        value: PRIYEMNAYA@ygdu_gazprom.ru
  type.gender:
    lowercase: true
    normalize: true
    options:
      - match: MALE
        value: male
  type.identifier:
    options:
      # Re-map invalid ISINs to generic regNr:
      - match:
          - BRC1EODR004 # CNOOC LIMITED
          - CND10002K094 # CHINA COMMUNICATIONS CONSTRUCTION COMPANY LIMITED
          - CND10002G601 # CHINA COMMUNICATIONS CONSTRUCTION COMPANY LIMITED
        prop: registrationNumber
